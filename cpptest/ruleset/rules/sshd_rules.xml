<group name="sshd">
  <rule id="5701" level="8">
    <match>Bad protocol version identification</match>
    <description>sshd: Possible attack on the ssh server (or version gathering).</description>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>

  <rule id="5704" level="4">
    <match>fatal: Timeout before authentication for</match>
    <description>sshd: Timeout while logging in.</description>
  </rule>

  <rule id="5705" level="10" frequency="6" timeframe="360">
    <if_matched_sid>5704</if_matched_sid>
    <description>sshd: Possible scan or breakin attempt (high number of login timeouts).</description>
    <mitre>
      <id>T1190, T1110</id>
    </mitre>
  </rule>

  <rule id="5706" level="6">
    <match>Did not receive identification string from</match>
    <description>sshd: insecure connection attempt (scan).</description>
    <mitre>
      <id>T1021.004</id>
    </mitre>
  </rule>

  <rule id="5707" level="14">
    <match>fatal: buffer_get_string: bad string</match>
    <description>sshd: OpenSSH challenge-response exploit.</description>
    <mitre>
      <id>T1210, T1068</id>
    </mitre>
  </rule>

  <rule id="5709" level="0">
    <match>error: Could not get shadow information for NOUSER|</match>
    <description>sshd: Useless SSHD message without an user/ip and context.</description>
  </rule>

  <rule id="5710" level="5">
    <match>illegal user|invalid user</match>
    <description>sshd: Attempt to login using a non-existent user</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="57110" level="0">
    <match>authentication failure; logname= uid=0 euid=0 tty=ssh</match>
    <description>sshd: Useless/Duplicated SSHD message without a user/ip.</description>
  </rule>

  <rule id="57111" level="0">
    <match>input_userauth_request: invalid user</match>
    <description>sshd: Useless/Duplicated SSHD message without a user/ip.</description>
  </rule>

  <rule id="57112" level="0">
    <match>PAM: User not known to the underlying authentication module for illegal user</match>
    <description>sshd: Useless/Duplicated SSHD message without a user/ip.</description>
  </rule>

  <rule id="57113" level="0">
    <match>error retrieving information about user</match>
    <description>sshd: Useless/Duplicated SSHD message without a user/ip.</description>
  </rule>

  <rule id="5712" level="10" frequency="8" timeframe="120" ignore="60">
    <if_matched_sid>5710</if_matched_sid>
    <same_source_ip />
    <description>sshd: brute force trying to get access to the system. Non existent user.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="5713" level="6">
    <if_matched_sid>5710</if_matched_sid>
    <match>Corrupted check bytes on</match>
    <description>sshd: Corrupted bytes on SSHD.</description>
  </rule>

  <rule id="5714" level="14" timeframe="120" frequency="3">
    <if_matched_sid>5713</if_matched_sid>
    <match>Local: crc32 compensation attack</match>
    <description>sshd: SSH CRC-32 Compensation attack</description>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>

  <rule id="5716" level="5">
    <if_matched_sid>5714</if_matched_sid>
    <match>Failed: PAM: Authentication</match>
    <description>sshd: authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="57161" level="5">
    <if_matched_sid>5714</if_matched_sid>
    <match>error: PAM: Authentication</match>
    <description>sshd: authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="57162" level="5">
    <if_matched_sid>5714</if_matched_sid>
    <match>error: PAM: Authentication2</match>
    <description>sshd: authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="57163" level="5">
    <if_matched_sid>5714</if_matched_sid>
    <match>error: PAM: Authentication3</match>
    <description>sshd: authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="57164" level="5">
    <if_matched_sid>5714</if_matched_sid>
    <match>error: PAM: Authentication4</match>
    <description>sshd: authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="57165" level="5">
    <if_matched_sid>5714</if_matched_sid>
    <match>error: PAM: Authentication5</match>
    <description>sshd: authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="5717" level="4">
    <match>error: Bad prime description in line</match>
    <description>sshd: configuration error (moduli).</description>
  </rule>

  <rule id="5718" level="5">
    <match>not allowed because</match>
    <description>sshd: Attempt to login using a denied user.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="5719" level="10" frequency="8" timeframe="120" ignore="60">
    <if_matched_sid>5718</if_matched_sid>
    <description>sshd: Multiple access attempts using a denied user.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="5720" level="10" frequency="8">
    <if_matched_sid>5716</if_matched_sid>
    <same_source_ip />
    <description>sshd: Multiple authentication failures.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="5721" level="0">
    <match>Received disconnect from</match>
    <description>sshd: System disconnected from sshd.</description>
  </rule>

  <rule id="5722" level="0">
    <match>Connection closed</match>
    <description>sshd: ssh connection closed.</description>
  </rule>

  <rule id="5723" level="0">
    <match>error: buffer_get_bignum2_ret: negative numbers not supported</match>
    <description>sshd: key error.</description>
  </rule>

  <rule id="5724" level="0">
    <match>fatal: buffer_get_bignum2: buffer error</match>
    <description>sshd: key error.</description>
  </rule>

  <rule id="5725" level="0">
    <match>fatal: Write failed: Host is down</match>
    <description>sshd: Host ungracefully disconnected.</description>
  </rule>

  <rule id="5726" level="5">
    <match>error: PAM: Module is unknown for</match>
    <description>sshd: Unknown PAM module, PAM misconfiguration.</description>
  </rule>

  <rule id="5727" level="0">
    <match>failed: Address already in use.</match>
    <description>sshd: Attempt to start sshd when something already bound to the port.</description>
  </rule>

  <rule id="5728" level="4">
    <match>Authentication service cannot retrieve user credentials</match>
    <description>sshd: Authentication services were not able to retrieve user credentials.</description>
  </rule>

  <rule id="5730" level="4">
    <match>Connection refused</match>
    <description>sshd: SSHD is not accepting connections.</description>
  </rule>

  <rule id="5731" level="6">
    <match>AKASSH_Version_Mapper1.</match>
    <description>sshd: SSH Scanning.</description>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>

  <rule id="5732" level="0">
    <match>error: connect_to </match>
    <description>sshd: Possible port forwarding failure.</description>
  </rule>

  <rule id="5733" level="0">
    <match>Invalid credentials</match>
    <description>sshd: User entered incorrect password.</description>
  </rule>

  <rule id="5734" level="0">
    <match>Could not load host key</match>
    <description>sshd: sshd could not load one or more host keys.</description>
    <info>This may be related to an upgrade to OpenSSH.</info>
  </rule>

  <rule id="5735" level="0">
    <match>Write failed: Broken pipe</match>
    <description>sshd: Failed write due to one host disappearing.</description>
  </rule>

  <rule id="5737" level="5">
    <match>fatal: Cannot bind any address</match>
    <description>sshd: cannot bind to configured address.</description>
  </rule>

  <rule id="5738" level="5">
    <match>set_loginuid failed opening</match>
    <description>sshd: pam_loginuid could not open loginuid.</description>
  </rule>

  <rule id="5739" level="4">
    <match>error: Could not stat AuthorizedKeysCommand</match>
    <description>sshd: configuration error (AuthorizedKeysCommand)</description>
  </rule>

  <rule id="5740" level="4">
    <match>Connection reset by peer</match>
    <description>sshd: connection reset by peer</description>
  </rule>

  <rule id="5741" level="4">
    <match>Connection refused</match>
    <description>sshd: connection refused</description>
  </rule>

  <rule id="5742" level="4">
    <match>Connection timed out</match>
    <description>sshd: connection timed out</description>
  </rule>

  <rule id="5743" level="4">
    <match>No route to host</match>
    <description>sshd: no route to host</description>
  </rule>

  <rule id="5744" level="4">
    <match>failure direct-tcpip</match>
    <description>sshd: port forwarding issue</description>
  </rule>

  <rule id="5745" level="4">
    <match>Transport endpoint is not connected</match>
    <description>sshd: transport endpoint is not connected</description>
  </rule>

  <rule id="5746" level="4">
    <match>get_remote_port failed</match>
    <description>sshd: get_remote_port failed</description>
  </rule>

  <!-- http://www.gossamer-threads.com/lists/openssh/users/47438 -->
  <rule id="5747" level="6">
    <match>bad client public DH value</match>
    <description>sshd: bad client public DH value</description>
  </rule>

  <rule id="5748" level="6">
    <match>Corrupted MAC on input</match>
    <description>sshd: corrupted MAC on input</description>
  </rule>

  <rule id="5749" level="4">
    <match>Bad packet length</match>
    <description>sshd: bad packet length</description>
  </rule>

  <rule id="5750" level="0">
    <match>Unable to negotiate with</match>
    <description>sshd: could not negotiate with client.</description>
  </rule>

  <rule id="5751" level="1">
    <match>no hostkey alg</match>
    <description>sshd: No hostkey alg.</description>
  </rule>

  <rule id="5752" level="2">
    <if_sid>5750</if_sid>
    <match>no matching key exchange method found</match>
    <description>sshd: Client did not offer an acceptable key exchange method.</description>
  </rule>

  <rule id="5753" level="2">
    <if_sid>5750</if_sid>
    <match>no matching cipher found</match>
    <description>sshd: could not negotiate with client, no matching cipher.</description>
  </rule>

  <rule id="5754" level="1">
    <match>Failed to create session: </match>
    <description>sshd: failed to create a session.</description>
  </rule>

  <rule id="5755" level="3">
    <match>bad ownership or modes for file</match>
    <description>sshd: Authentication refused due to owner/permissions of authorized_keys.</description>
  </rule>

  <rule id="5756" level="0">
    <match> failed, subsystem not found</match>
    <description>sshd: subsystem request failed.</description>
  </rule>

  <rule id="5757" level="0">
    <match>but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!</match>
    <description>Bad DNS mapping.</description>
  </rule>

  <rule id="5758" level="8">
    <if_matched_sid>5710</if_matched_sid>
    <match>error: maximum authentication attempts exceeded </match>
    <description>Maximum authentication attempts exceeded.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="5759" level="2">
    <if_matched_sid>5750</if_matched_sid>
    <match>no matching mac found</match>
    <description>sshd: could not negotiate with client, no matching mac.</description>
  </rule>

  <rule id="5761" level="0">
    <match>Disconnected from user</match>
    <description>sshd: ssh connection closed.</description>
  </rule>

  <rule id="5762" level="4">
    <match>Connection reset</match>
    <description>sshd: connection reset</description>
  </rule>

  <rule id="5760" level="5">
    <if_matched_sid>5716</if_matched_sid>
    <match>Failed password</match>
    <description>sshd: authentication failed.</description>
  </rule>

  <rule id="5763" level="10" frequency="8" timeframe="120" ignore="60">
    <if_matched_sid>5760</if_matched_sid>
    <same_source_ip/>
    <description>sshd: brute force trying to get access to the system. Authentication failed.</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

</group>
